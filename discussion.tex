\chapter{Conclusion, Discussion, and Future Work}

When working at the scale of whole genomes, the problem of extending indexing strategies to graphs becomes very important. In addition to that, indexing more than one sample in the same data structure adds to the complexity of the problem. In this document, we presented two data structures for indexing a collection of genomes, transcriptomes, or sample reads in the form of a colored de Bruijn graph or a compacted de Bruijn graph. Both of these data structures make use of succinct representations along with rank and select operations. As future direction, we are interested in exploring different applications for these two data structures, as well as investigating the relationship between the two to see how we can merge them into one multi-purpose data structure, that can then be a part of different pipelines for mapping and assembly and merged with different representations of a de Bruijn graph, including succinct representations like \boss~\cite{BoweOn12} and TwoPaCo~\cite{minkin2016twopaco}.

In the colored de Bruijn graph, the only information we keep per \kmer in the indexing data structure regarding different samples (genomes, sequence read samples, etc.) is its membership. Therefore, one direction for future work for indexing a \cdbg could be having different types of annotations, in addition to membership; annotations like position and orientation for a reference based \cdbg, and frequency for both reference and assembly based. Moreover, it will be interesting to explore how multiple attributes could be efficiently stored simultaneously, and how potential correlations between these attributes might be exploited. For example, might be able to take advantage of the coherence in annotation (i.e., color or count information) shared among the constituent \kmers of a contig, allowing one to store only the information where these annotations change during traversal.

Another area of interest towards improving space efficiency of \cdbgs can be exploring other ways to use fewer colors to represent all samples instead of compressing the color matrix. One idea, we have been discussing with Travis Gagie and Christina Bousher for potential collaborations, is to reuse the previously assigned colors in disjoint subgraphs and non-adjacent edges. In other words, we cannot reuse the same color for a different sample for \kmers that are adjacent, but we can have colors that are globally reused. In this case, we need to have a proper mapping from a color to its corresponding samples in different disjoint areas of the graph. As a de Bruijn graph is a special type of directed graphs with each node having at most $4$ incoming and $4$ outgoing edges, the chromatic number of such a graph is at most $9$ (maximum degree + 1~\footnote{Brooks' theorem})~\cite{cranston2015brooks}. Therefore, if we can design an efficient color-to-sample mapping, we can reduce the colors in the graph and skip assigning one bit to each color. In this case, we are approaching the problem from a different direction, rather than compressing the color matrix that we explained in \ref{sec:rainbowfish}.

In the third chapter, we talked about a new indexing tool, \pufferfish. The main advantage of a data structure like \pufferfish compared to a linear index is the ability to efficiently map reads to a population of genomes or individual genomes with annotated variants. Current tools that are used for alignment and mapping are either suitable for genome or transcriptome, but not both. \pufferfish fills the gap by allowing fast and accurate mapping to a collection of genomes and transcriptomes at the same time. This ability paves the way for accomplishing applications such as novel exon discovery or RNA-seq quality control. 
Because of the distinction between methods that map to the transcriptome and those that map to the genome, we lose information that can be derived by putting both of these mappings together. One immediate outcome of having short reads mapped to both genome and transcriptome is in RNA-seq quality control. If we just look at the transcriptome mapping outcome, we could simply throw all the non-mapped reads out, ignoring the fact that not being mapped at all is a different observation than being mapped to an intron. A large fraction of reads mapping to introns is an evidence that the RNA-seq experiment failed to provide the required quality. Having reads that map to both the genome and transcriptome, we can account for such an experiment's failure. Another application of dual mapping, that is of biological importance, is looking for any intron retention in an RNA-seq experiment. High probability of retaining introns in reads from RNA-seq experiments is known to be associated with certain disease phenotypes~\cite{faustino2003pre,tazi2009alternative}. By mapping the reads to just transcriptomes, we can never be aware of intron retention statistics.

Another problem that can be answered using \pufferfish is finding structureal variations in a metagenomic data set or across different samples of the same individual~\cite{korbel2007paired,tuzun2005fine}. One particular way to approach this problem is through genome alignment~\cite{korbel2007paired}. Having a genome indexed using \pufferfish, we can map another genome to it instead of a set of short reads. In a similar way, we can index multiple genomes at the same time into one data structure combining the concepts of indexing a colored de Bruijn graph and a compacted de Bruijn graph. There are a lot of small scale variations happening across two genomes that can be the result of an error in the read sequencing process or that may not be informative enough. However, many biologically interesting variations across genomes happen at scales longer than the length of the read. Building \pufferfish along a collection of genomes will allow us to search for such variations. One specific type of variation can be inversions between genomes where an interval of one genome is the same as the other, but inverted~\cite{feuk2010inversion,turner2006assaying}.
%, so that we have a one-to-one correspondence between \kmers of two separate genomes and at some location the positions start decreasing in one genome as we increase position in the other. 
The inversions can be identified by a data structure like \pufferfish that keeps position of a \kmer in all the references.
